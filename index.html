<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>STEM PUZZLE Â· GLOW EDITION</title>
  <!-- CDNs: animations, icons, fonts, confetti -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Quicksand', sans-serif;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at 10% 30%, #0f2027, #030b17);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }

    /* glowing effect on cards */
    .glow-card {
      background: rgba(20, 40, 60, 0.75);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: 48px;
      padding: 32px 28px;
      box-shadow: 0 0 30px rgba(0, 255, 255, 0.5), 0 20px 35px -8px black, inset 0 1px 3px rgba(255,255,255,0.3);
      border: 1px solid rgba(0, 255, 255, 0.3);
      transition: box-shadow 0.2s;
    }
    .glow-card:hover {
      box-shadow: 0 0 45px cyan, 0 25px 40px -10px black;
    }

    .game-wrapper {
      width: 100%;
      max-width: 900px;
    }

    /* common card style */
    .stem-card {
      background: rgba(16, 26, 51, 0.9);
      backdrop-filter: blur(4px);
      border-radius: 48px;
      padding: 32px 28px;
      box-shadow: 0 30px 40px -15px #000, 0 0 30px #7df9ff;
      border: 1px solid rgba(255, 255, 255, 0.8);
    }

    /* start menu specific */
    #startContainer {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      background: rgba(10, 30, 45, 0.85);
      backdrop-filter: blur(16px);
      border: 2px solid #4df0ff;
      box-shadow: 0 0 80px #00ffff, 0 20px 40px black;
    }
    .start-title {
      font-size: 4rem;
      font-weight: 800;
      background: linear-gradient(45deg, #aaffff, #ffb3ff, #ffffaa);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 20px rgb(215, 168, 215), 0 0 40px cyan;
      margin-bottom: 20px;
    }
    /* shaking + glowing start button */
    .start-btn {
      background: linear-gradient(145deg, #ffb347, #ff7e05);
      border: none;
      border-radius: 80px;
      padding: 28px 80px;
      font-size: 3rem;
      font-weight: 800;
      color: #0b1f2b;
      text-transform: uppercase;
      letter-spacing: 5px;
      box-shadow: 0 0 40px #ffae00, 0 15px 30px #b45f06;
      cursor: pointer;
      transition: 0.1s;
      border: 2px solid #fff6b0;
      animation: shakeGlow 1.5s infinite ease-in-out;
    }
    @keyframes shakeGlow {
      0% { transform: translate(0, 0) scale(1); box-shadow: 0 0 40px #ffae00; }
      25% { transform: translate(3px, -3px) scale(1.02); box-shadow: 0 0 60px #ffdd55; }
      50% { transform: translate(-3px, 3px) scale(1.02); box-shadow: 0 0 80px #ff8800; }
      75% { transform: translate(2px, 2px) scale(1.01); box-shadow: 0 0 60px #ffaa33; }
      100% { transform: translate(0, 0) scale(1); box-shadow: 0 0 40px #ffae00; }
    }
    .start-btn:hover {
      filter: brightness(1.2);
      box-shadow: 0 0 100px gold, 0 20px 40px darkorange;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 28px;
      flex-wrap: wrap;
      gap: 12px;
    }
    .title-section {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .stem-puzzle-logo {
      font-size: 2.2rem;
      font-weight: 700;
      background: linear-gradient(135deg, #0ff, #f0f, #ff0);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 15px cyan, 0 0 30px magenta;
    }
    .score-board {
      background: #1a2f3f;
      border-radius: 60px;
      padding: 12px 22px;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: 0 0 20px #2af, inset 0 -3px 0 #0f1a2b;
    }
    .score-board i {
      color: #fbbf24;
      font-size: 1.5rem;
      filter: drop-shadow(0 0 10px gold);
    }
    .score-text {
      font-weight: 700;
      font-size: 1.9rem;
      color: #fff;
      background: #0f1a2b;
      padding: 2px 16px;
      border-radius: 40px;
      box-shadow: inset 0 -2px 0 cyan;
    }
    .icon-btn {
      background: rgba(255,255,255,0.2);
      width: 48px;
      height: 48px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      transition: 0.2s;
      border: 1px solid rgba(0,255,255,0.6);
      box-shadow: 0 0 15px cyan;
    }
    .icon-btn:hover {
      background: #2aa9c9;
      transform: scale(1.1) rotate(5deg);
      box-shadow: 0 0 30px #0ff;
    }

    .q-progress {
      background: #d9e2ef;
      border-radius: 60px;
      height: 14px;
      width: 100%;
      margin: 20px 0 25px;
      overflow: hidden;
      box-shadow: inset 0 2px 5px rgba(0,0,0,0.4), 0 0 15px #4af;
    }
    .q-fill {
      height: 100%;
      background: linear-gradient(90deg, #00f2ff, #aa4aff);
      border-radius: 60px;
      transition: width 0.3s ease;
      box-shadow: 0 0 20px #0ff;
    }

    .q-text {
      font-size: 1.6rem;
      font-weight: 600;
      color: #0b2b3f;
      margin-bottom: 30px;
      background: #eef5fc;
      padding: 20px 25px;
      border-radius: 40px;
      box-shadow: 0 0 20px #b0e0ff, inset 0 -3px 0 #bdd3e8;
      border: 1px solid cyan;
    }

    .options-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin: 20px 0 28px;
    }

    .option {
      background: linear-gradient(145deg, #fff8, #fff);
      border: none;
      border-radius: 40px;
      padding: 22px 12px;
      font-size: 1.3rem;
      font-weight: 700;
      color: #004466;
      box-shadow: 0 10px 0 #a2b9ce, 0 0 25px #4ae, 0 10px 20px -5px black;
      cursor: pointer;
      transition: all 0.07s ease;
      text-align: center;
      border: 2px solid #9fdbfc;
    }
    .option:hover:not(:disabled) {
      transform: translateY(-5px);
      box-shadow: 0 12px 0 #809bb3, 0 0 45px cyan, 0 15px 25px -5px #001122;
      background: #f0fbff;
    }
    .option:active:not(:disabled) {
      transform: translateY(4px);
      box-shadow: 0 6px 0 #809bb3, 0 0 35px deepskyblue;
    }
    .option.correct {
      background: #00c851 !important;
      border-color: #00e676 !important;
      color: white !important;
      box-shadow: 0 6px 0 #007e33, 0 0 50px #6aff00 !important;
    }
    .option.wrong {
      background: #ff4444 !important;
      border-color: #ff8888 !important;
      color: white !important;
      box-shadow: 0 6px 0 #aa2222, 0 0 50px red !important;
    }

    .next-btn {
      background: linear-gradient(145deg, #2a7faa, #0c4a6e);
      border: none;
      border-radius: 60px;
      padding: 18px 40px;
      font-size: 1.7rem;
      font-weight: 700;
      color: white;
      width: fit-content;
      margin: 0 auto 10px;
      box-shadow: 0 9px 0 #083047, 0 0 40px cyan;
      cursor: pointer;
      transition: 0.08s linear;
      display: flex;
      align-items: center;
      gap: 15px;
      border: 1px solid #9eefff;
    }
    .next-btn:active {
      transform: translateY(5px);
      box-shadow: 0 4px 0 #083047, 0 0 40px deepskyblue;
    }
    .next-btn.hidden {
      display: none;
    }

    .result-container {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 30px 15px;
    }
    .result-icon {
      font-size: 5rem;
      color: #fbbf24;
      filter: drop-shadow(0 0 25px gold);
      margin-bottom: 20px;
    }
    .result-message {
      font-size: 2.4rem;
      font-weight: 700;
      background: linear-gradient(145deg, #0ff, #f6f);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 30px cyan;
    }
    .sub-message {
      font-size: 1.4rem;
      background: white;
      padding: 14px 35px;
      border-radius: 60px;
      font-weight: 600;
      color: #124263;
      box-shadow: 0 0 30px #0ff, 0 6px 0 #abc0d0;
      margin: 25px 0;
    }
    .restart-big {
      background: #0b4b6b;
      border: none;
      border-radius: 60px;
      padding: 16px 45px;
      font-size: 1.8rem;
      color: white;
      font-weight: 700;
      box-shadow: 0 8px 0 #052c3f, 0 0 40px aqua;
      cursor: pointer;
      transition: 0.07s;
      border: 1px solid cyan;
    }
    .restart-big:active {
      transform: translateY(5px);
      box-shadow: 0 3px 0 #052c3f, 0 0 60px deepskyblue;
    }

    .footer {
      text-align: center;
      margin-top: 15px;
      color: rgba(255,255,255,0.7);
      font-weight: 500;
      text-shadow: 0 0 8px cyan;
    }
    .highlight {
      background: #e7b42c;
      color: #1e293b;
      padding: 2px 10px;
      border-radius: 40px;
      box-shadow: 0 0 20px gold;
    }

    /* pop animation for start button */
    .pop-in {
      animation: pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    @keyframes pop {
      0% { transform: scale(0.2); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }
  </style>
</head>
<body>
<div class="game-wrapper">
  <!-- START MENU (visible initially) -->
  <div id="startContainer" class="glow-card" style="display: flex;">
    <div class="start-title pop-in"><i class="fas fa-flask"></i> STEM PUZZLE</div>
    <button id="startGameBtn" class="start-btn animate__animated animate__infinite animate__shakeX">â–¶ START</button>
    <div style="margin-top: 40px; font-size: 1.4rem; color: #aff; text-shadow: 0 0 10px cyan;">20 STEM questions Â· score â‰¥15 to win</div>
  </div>

  <!-- GAME CONTAINER (hidden initially) -->
  <div id="gameContainer" class="stem-card" style="display: none;">
    <div class="header">
      <div class="title-section">
        <span class="stem-puzzle-logo"><i class="fas fa-puzzle-piece"></i> STEM PUZZLE</span>
      </div>
      <div style="display: flex; align-items: center; gap: 15px;">
        <div class="score-board">
          <i class="fas fa-star"></i>
          <span id="scoreDisplay" class="score-text">0</span>
        </div>
        <!-- home button to return to start menu -->
        <div id="homeBtn" class="icon-btn" title="main menu">
          <i class="fas fa-home"></i>
        </div>
        <div id="restartHeader" class="icon-btn" title="restart game">
          <i class="fas fa-undo-alt"></i>
        </div>
      </div>
    </div>
    <!-- progress -->
    <div class="q-progress">
      <div id="progressFill" class="q-fill" style="width: 5%;"></div>
    </div>
    <!-- question area -->
    <div id="questionText" class="q-text animate__animated">Loading STEM challenge...</div>
    <!-- options grid -->
    <div id="optionsContainer" class="options-grid">
      <!-- JS will inject 4 buttons -->
    </div>
    <!-- next button -->
    <button id="nextButton" class="next-btn hidden"><i class="fas fa-arrow-right"></i> NEXT</button>
  </div>

  <!-- RESULT CONTAINER (hidden initially) -->
  <div id="resultContainer" class="stem-card result-container" style="display: none;">
    <div class="result-icon"><i class="fas fa-microscope"></i></div>
    <div id="resultMainMsg" class="result-message"></div>
    <div id="resultSubMsg" class="sub-message"></div>
    <button id="restartFromResult" class="restart-big"><i class="fas fa-play"></i> PLAY AGAIN</button>
  </div>

  <div class="footer"><span class="highlight">â˜… STEM PUZZLE â˜…</span> 20 puzzles Â· requirements: 15+</div>
</div>

<script>
  (function() {
    // ----- 20 STEM questions array (vibrant mix) -----
    const questions = [
      { question: "What is the hardest natural substance on Earth?", options: ["Diamond", "Gold", "Iron", "Platinum"], correct: 0 },
      { question: "Which planet is known as the Red Planet?", options: ["Mars", "Venus", "Jupiter", "Saturn"], correct: 0 },
      { question: "What is the chemical symbol for gold?", options: ["Go", "Gd", "Au", "Ag"], correct: 2 },
      { question: "What is the value of Ï€ (pi) rounded to two decimals?", options: ["3.14", "3.16", "3.12", "3.18"], correct: 0 },
      { question: "Which part of the cell contains the genetic material?", options: ["Nucleus", "Ribosome", "Mitochondria", "Cytoplasm"], correct: 0 },
      { question: "What does 'HTTP' stand for?", options: ["HyperText Transfer Protocol", "High Tech Transfer Program", "Hyper Transfer Text Protocol", "Home Tool Transfer Protocol"], correct: 0 },
      { question: "Which is the smallest prime number?", options: ["0", "1", "2", "3"], correct: 2 },
      { question: "What is the speed of light in vacuum (approx)?", options: ["300,000 km/s", "150,000 km/s", "1 million km/s", "3,000 km/s"], correct: 0 },
      { question: "Which blood type is a universal donor?", options: ["O-", "AB+", "A+", "B-"], correct: 0 },
      { question: "What is the main gas found in Earth's atmosphere?", options: ["Oxygen", "Carbon dioxide", "Nitrogen", "Argon"], correct: 2 },
      { question: "Which element has the atomic number 1?", options: ["Helium", "Hydrogen", "Oxygen", "Carbon"], correct: 1 },
      { question: "What is the powerhouse of the cell?", options: ["Nucleus", "Mitochondria", "Ribosome", "Golgi"], correct: 1 },
      { question: "Which programming language is known for web interactivity?", options: ["Python", "Java", "JavaScript", "C++"], correct: 2 },
      { question: "What does CPU stand for?", options: ["Central Processing Unit", "Computer Personal Unit", "Central Process Unit", "Central Programming Unit"], correct: 0 },
      { question: "Which is a renewable energy source?", options: ["Coal", "Natural Gas", "Solar", "Nuclear"], correct: 2 },
      { question: "What is the largest organ in the human body?", options: ["Heart", "Liver", "Skin", "Brain"], correct: 2 },
      { question: "What is the square root of 64?", options: ["6", "7", "8", "9"], correct: 2 },
      { question: "Which planet has the most moons?", options: ["Earth", "Mars", "Jupiter", "Saturn"], correct: 3 }, // Saturn (82) / Jupiter (79) â€“ but commonly Saturn, we'll pick Saturn
      { question: "What is the chemical formula for table salt?", options: ["NaCl", "KCl", "H2O", "CO2"], correct: 0 },
      { question: "Which year did the first manned moon landing occur?", options: ["1965", "1969", "1972", "1958"], correct: 1 }
    ];

    const totalQuestions = questions.length; // 20
    const MIN_SCORE_TO_MEET = 15;   // STEM requirement threshold

    // DOM elements
    const startContainer = document.getElementById('startContainer');
    const gameContainer = document.getElementById('gameContainer');
    const resultContainer = document.getElementById('resultContainer');
    const questionEl = document.getElementById('questionText');
    const optionsContainer = document.getElementById('optionsContainer');
    const nextBtn = document.getElementById('nextButton');
    const scoreDisplay = document.getElementById('scoreDisplay');
    const progressFill = document.getElementById('progressFill');
    const restartHeader = document.getElementById('restartHeader');
    const homeBtn = document.getElementById('homeBtn');
    const startGameBtn = document.getElementById('startGameBtn');
    const restartResultBtn = document.getElementById('restartFromResult');
    const resultMainMsg = document.getElementById('resultMainMsg');
    const resultSubMsg = document.getElementById('resultSubMsg');

    // state
    let currentQuestionIndex = 0;
    let score = 0;
    let answered = false;
    let optionButtons = [];

    // Helper: remove animations from elements
    function removeAllAnimations(elements) {
      elements.forEach(el => {
        el.classList.remove('animate__animated', 'animate__tada', 'animate__shakeX', 'animate__flash', 'animate__pulse', 'animate__rubberBand');
      });
    }

    // Update score display with optional pulse
    function updateScoreDisplay(noAnim = false) {
      scoreDisplay.innerText = score;
      if (!noAnim) {
        scoreDisplay.classList.add('animate__animated', 'animate__pulse');
        setTimeout(() => {
          scoreDisplay.classList.remove('animate__animated', 'animate__pulse');
        }, 400);
      }
    }

    // Load question by index
    function loadQuestion(index) {
      answered = false;
      const q = questions[index];
      questionEl.innerText = q.question;
      questionEl.classList.add('animate__animated');
      setTimeout(() => questionEl.classList.remove('animate__animated', 'animate__fadeInLeft'), 500);

      // Update progress bar (each question = 100%/total)
      progressFill.style.width = `${((index + 1) / totalQuestions) * 100}%`;

      // Update options
      if (optionButtons.length === 0) {
        // create buttons if not exist
        for (let i = 0; i < 4; i++) {
          const btn = document.createElement('button');
          btn.className = 'option';
          btn.setAttribute('data-index', i);
          optionsContainer.appendChild(btn);
        }
        optionButtons = Array.from(document.querySelectorAll('.option'));
      }

      // Set text and reset styles
      optionButtons.forEach((btn, i) => {
        btn.innerText = q.options[i] || "---";
        btn.disabled = false;
        btn.classList.remove('correct', 'wrong', 'animate__animated', 'animate__tada', 'animate__shakeX', 'animate__flash');
      });

      // Hide next button until answer
      nextBtn.classList.add('hidden');
      // Adjust button text for last question
      if (index === totalQuestions - 1) {
        nextBtn.innerHTML = '<i class="fas fa-trophy"></i> RESULTS';
      } else {
        nextBtn.innerHTML = '<i class="fas fa-arrow-right"></i> NEXT';
      }
    }

    // Handle option click
    optionsContainer.addEventListener('click', (e) => {
      const target = e.target.closest('.option');
      if (!target || answered || target.disabled) return;

      const selectedIdx = parseInt(target.getAttribute('data-index'), 10);
      const currentQ = questions[currentQuestionIndex];
      const isCorrect = (selectedIdx === currentQ.correct);

      // Disable all buttons
      optionButtons.forEach(btn => btn.disabled = true);
      answered = true;

      removeAllAnimations(optionButtons);

      // Mark correct answer (always green)
      const correctBtn = optionButtons[currentQ.correct];
      correctBtn.classList.add('correct');

      if (!isCorrect) {
        target.classList.add('wrong');
        target.classList.add('animate__animated', 'animate__shakeX');
        correctBtn.classList.add('animate__animated', 'animate__tada');
      } else {
        target.classList.add('correct'); // already added, but fine
        target.classList.add('animate__animated', 'animate__rubberBand');
      }

      if (isCorrect) {
        score++;
        updateScoreDisplay();
      }

      // Show next button with headshake
      nextBtn.classList.remove('hidden');
      nextBtn.classList.add('animate__animated', 'animate__headShake');
      setTimeout(() => nextBtn.classList.remove('animate__animated', 'animate__headShake'), 600);
    });

    // Next button handler
    nextBtn.addEventListener('click', () => {
      if (!answered) return;
      if (currentQuestionIndex === totalQuestions - 1) {
        showResultScreen();
      } else {
        currentQuestionIndex++;
        loadQuestion(currentQuestionIndex);
      }
    });

    // Show final result
    function showResultScreen() {
      gameContainer.style.display = 'none';
      resultContainer.style.display = 'flex';

      const meetReq = score >= MIN_SCORE_TO_MEET;
      resultMainMsg.innerText = meetReq ? 'ðŸŒˆ STEM ACHIEVED! ðŸŒˆ' : 'ðŸ”¬ KEEP EXPLORING';
      resultSubMsg.innerText = `You scored ${score} / ${totalQuestions}  â€¢  ${meetReq ? 'REQUIREMENTS MET' : 'STEM requirements not met (need 15+)'}`;

      if (meetReq) {
        confetti({ particleCount: 150, spread: 100, origin: { y: 0.6 } });
        confetti({ particleCount: 100, spread: 160, origin: { y: 0.5, x: 0.2 }, startVelocity: 25 });
        confetti({ particleCount: 100, spread: 160, origin: { y: 0.5, x: 0.8 }, startVelocity: 25 });
      }

      resultContainer.classList.add('animate__animated', 'animate__fadeInUp');
      setTimeout(() => resultContainer.classList.remove('animate__animated', 'animate__fadeInUp'), 800);
    }

    // Reset game to initial state (question 0, score 0) and show game container
    function resetAndStartGame() {
      currentQuestionIndex = 0;
      score = 0;
      answered = false;
      updateScoreDisplay(true);
      loadQuestion(0);
      gameContainer.style.display = 'block';
      resultContainer.style.display = 'none';
      startContainer.style.display = 'none';
    }

    // Return to start menu
    function goToStartMenu() {
      startContainer.style.display = 'flex';
      gameContainer.style.display = 'none';
      resultContainer.style.display = 'none';
      // optionally reset any state, but not necessary
    }

    // Restart game (from header or result)
    function restartGame() {
      resetAndStartGame();
    }

    // Event listeners
    startGameBtn.addEventListener('click', () => {
      resetAndStartGame();
    });

    restartHeader.addEventListener('click', () => {
      restartGame();
    });

    homeBtn.addEventListener('click', () => {
      goToStartMenu();
    });

    restartResultBtn.addEventListener('click', () => {
      restartGame();
    });

    // Initialize: show start menu, game hidden, result hidden
    // Already done via inline style, but ensure correct display
    startContainer.style.display = 'flex';
    gameContainer.style.display = 'none';
    resultContainer.style.display = 'none';

    // Pre-create option buttons? Not necessary, will be created on first load.
    // But to avoid empty container, we can let loadQuestion create them.
    // However we need to reset optionButtons array when restarting
    // We'll handle in resetAndStartGame: loadQuestion will recreate if needed.
    // We'll also clear optionsContainer on init to be safe.
    optionsContainer.innerHTML = '';
    optionButtons = [];
  })();
</script>
</body>
</html>